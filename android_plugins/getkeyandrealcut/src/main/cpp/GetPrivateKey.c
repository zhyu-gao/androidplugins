#include <jni.h>
#include <stdint.h>
#include <string.h>

extern int isTrue;

int GetKey(int key, char keys[])
{
    if (isTrue == 1)
    {
        int aa[20][36] =
                {
                        {1527, 1603, 1601, 1582, 1556, 1587, 1577, 1531, 1600, 1582, 1554,
                                1585, 1579, 1559, 1595, 1544, 1604, 1531, 1564, 1579, 1523, 1520,
                                1561, 1533, 1528, 1545, 1541, 1522, 1527, 1605, 1525, 1545, 1604,
                                1566, 1563, 1605},
                        {1597, 1527, 1523, 1586, 1559, 1570, 1561, 1537, 1566, 1521, 1605,
                                1555, 1526, 1569, 1543, 1603, 1548, 1518, 1605, 1574, 1541, 1584,
                                1587, 1568, 1521, 1589, 1568, 1548, 1536, 1538, 1531, 1556, 1554,
                                1555, 1521, 1572},
                        {1536, 1586, 1538, 1588, 1535, 1556, 1590, 1556, 1578, 1557, 1573,
                                1557, 1523, 1553, 1547, 1604, 1539, 1567, 1526, 1556, 1585, 1602,
                                1536, 1576, 1573, 1548, 1546, 1587, 1545, 1540, 1581, 1585, 1568,
                                1558, 1566, 1588},
                        {1571, 1589, 1525, 1535, 1561, 1522, 1586, 1576, 1518, 1524, 1557,
                                1550, 1596, 1590, 1522, 1603, 1582, 1596, 1550, 1594, 1575, 1604,
                                1526, 1547, 1565, 1536, 1526, 1525, 1583, 1602, 1603, 1532, 1549,
                                1540, 1590, 1523},
                        {1553, 1520, 1518, 1553, 1550, 1581, 1548, 1518, 1589, 1536, 1571,
                                1575, 1564, 1589, 1537, 1526, 1535, 1603, 1545, 1580, 1600, 1570,
                                1603, 1591, 1591, 1601, 1605, 1605, 1521, 1556, 1558, 1544, 1551,
                                1566, 1579, 1522},
                        {1528, 1554, 1532, 1604, 1549, 1525, 1542, 1564, 1545, 1600, 1540,
                                1527, 1553, 1524, 1550, 1525, 1566, 1535, 1586, 1588, 1560, 1537,
                                1595, 1582, 1589, 1545, 1539, 1523, 1551, 1591, 1569, 1539, 1605,
                                1587, 1529, 1550},
                        {1574, 1549, 1540, 1538, 1527, 1559, 1587, 1554, 1557, 1554, 1568,
                                1555, 1563, 1560, 1522, 1581, 1527, 1591, 1590, 1535, 1524, 1523,
                                1550, 1582, 1603, 1582, 1594, 1542, 1557, 1527, 1522, 1593, 1597,
                                1527, 1592, 1603},
                        {1524, 1605, 1566, 1589, 1530, 1557, 1536, 1578, 1570, 1563, 1578,
                                1553, 1599, 1535, 1584, 1526, 1532, 1567, 1532, 1602, 1601, 1599,
                                1585, 1526, 1530, 1573, 1596, 1532, 1529, 1532, 1560, 1569, 1600,
                                1569, 1526, 1564},
                        {1569, 1552, 1579, 1567, 1550, 1598, 1540, 1568, 1528, 1532, 1590,
                                1536, 1605, 1596, 1597, 1598, 1583, 1563, 1549, 1518, 1530, 1592,
                                1594, 1529, 1585, 1529, 1571, 1585, 1537, 1586, 1583, 1592, 1605,
                                1600, 1549, 1554},
                        {1574, 1525, 1582, 1594, 1520, 1546, 1561, 1533, 1572, 1559, 1525,
                                1554, 1525, 1588, 1537, 1587, 1576, 1540, 1597, 1524, 1548, 1539,
                                1521, 1560, 1572, 1592, 1585, 1529, 1526, 1549, 1558, 1533, 1567,
                                1525, 1521, 1570},
                        {1524, 1563, 1535, 1528, 1518, 1570, 1553, 1569, 1568, 1572, 1579,
                                1558, 1544, 1521, 1569, 1522, 1564, 1524, 1526, 1588, 1589, 1557,
                                1533, 1604, 1605, 1586, 1542, 1531, 1523, 1542, 1594, 1577, 1605,
                                1522, 1545, 1579},
                        {1574, 1601, 1587, 1563, 1564, 1603, 1533, 1605, 1586, 1530, 1562,
                                1539, 1548, 1599, 1538, 1601, 1575, 1526, 1604, 1547, 1571, 1573,
                                1546, 1536, 1582, 1534, 1538, 1603, 1603, 1571, 1594, 1566, 1543,
                                1561, 1590, 1548},
                        {1586, 1519, 1519, 1539, 1522, 1538, 1558, 1532, 1569, 1564, 1603,
                                1599, 1563, 1523, 1549, 1522, 1587, 1535, 1553, 1573, 1577, 1561,
                                1604, 1536, 1561, 1582, 1589, 1598, 1534, 1572, 1548, 1558, 1523,
                                1561, 1582, 1555},
                        {1564, 1554, 1585, 1595, 1541, 1582, 1562, 1601, 1591, 1555, 1577,
                                1533, 1558, 1585, 1550, 1522, 1549, 1586, 1578, 1599, 1588, 1536,
                                1600, 1602, 1556, 1567, 1561, 1518, 1536, 1558, 1602, 1601, 1551,
                                1529, 1541, 1600},
                        {1539, 1602, 1548, 1519, 1599, 1605, 1588, 1565, 1547, 1588, 1555,
                                1539, 1544, 1593, 1536, 1535, 1586, 1529, 1533, 1530, 1563, 1562,
                                1589, 1570, 1531, 1555, 1600, 1588, 1568, 1605, 1529, 1604, 1567,
                                1580, 1537, 1525},
                        {1574, 1560, 1537, 1562, 1603, 1564, 1599, 1541, 1575, 1540, 1581,
                                1599, 1543, 1587, 1527, 1578, 1521, 1570, 1567, 1591, 1541, 1570,
                                1532, 1593, 1570, 1563, 1559, 1518, 1553, 1596, 1569, 1540, 1519,
                                1587, 1574, 1565},
                        {1530, 1599, 1550, 1555, 1537, 1565, 1548, 1602, 1552, 1559, 1573,
                                1537, 1536, 1520, 1577, 1531, 1557, 1522, 1561, 1587, 1554, 1591,
                                1562, 1592, 1523, 1575, 1593, 1536, 1531, 1564, 1572, 1554, 1588,
                                1548, 1542, 1521},
                        {1597, 1539, 1551, 1581, 1600, 1605, 1595, 1554, 1549, 1531, 1565,
                                1521, 1601, 1602, 1565, 1576, 1600, 1568, 1549, 1524, 1534, 1553,
                                1576, 1540, 1592, 1548, 1590, 1551, 1594, 1594, 1573, 1521, 1588,
                                1580, 1546, 1566},
                        {1531, 1559, 1527, 1545, 1581, 1547, 1604, 1572, 1575, 1571, 1588,
                                1544, 1585, 1580, 1527, 1603, 1578, 1582, 1553, 1527, 1596, 1586,
                                1518, 1539, 1590, 1536, 1579, 1577, 1578, 1574, 1599, 1546, 1548,
                                1590, 1598, 1605},
                        {1563, 1529, 1521, 1572, 1536, 1557, 1570, 1569, 1543, 1529, 1531,
                                1541, 1575, 1558, 1536, 1587, 1552, 1528, 1595, 1550, 1570, 1530,
                                1591, 1596, 1541, 1547, 1583, 1603, 1533, 1593, 1529, 1545, 1532,
                                1569, 1551, 1557}};
        if (key > sizeof(aa))
        {
            return 0;
        }
        int i = 0;
        int length = sizeof(aa[key]);
        for (i = 0; i < sizeof(aa[key]); i++)
        {
            keys[i] = (char)(aa[key][i] - 1483);
        }
        return sizeof(aa[key]);
    }
    else
    {
        return 0;
    }
}

jintArray Java_com_newvision_checksignandrealcut_CheckSign_GetPrivateKey(JNIEnv *env,
                                                                        jobject thiz, jint num)
{
    if(isTrue == 0)
        return NULL;
    jintArray jcharArray1 = (*env)->NewIntArray(env, 36);
    int buffer[36] = {};
    int aa[20][36] =
            {
                    {1527, 1603, 1601, 1582, 1556, 1587, 1577, 1531, 1600, 1582, 1554,
                            1585, 1579, 1559, 1595, 1544, 1604, 1531, 1564, 1579, 1523, 1520,
                            1561, 1533, 1528, 1545, 1541, 1522, 1527, 1605, 1525, 1545, 1604,
                            1566, 1563, 1605},
                    {1597, 1527, 1523, 1586, 1559, 1570, 1561, 1537, 1566, 1521, 1605,
                            1555, 1526, 1569, 1543, 1603, 1548, 1518, 1605, 1574, 1541, 1584,
                            1587, 1568, 1521, 1589, 1568, 1548, 1536, 1538, 1531, 1556, 1554,
                            1555, 1521, 1572},
                    {1536, 1586, 1538, 1588, 1535, 1556, 1590, 1556, 1578, 1557, 1573,
                            1557, 1523, 1553, 1547, 1604, 1539, 1567, 1526, 1556, 1585, 1602,
                            1536, 1576, 1573, 1548, 1546, 1587, 1545, 1540, 1581, 1585, 1568,
                            1558, 1566, 1588},
                    {1571, 1589, 1525, 1535, 1561, 1522, 1586, 1576, 1518, 1524, 1557,
                            1550, 1596, 1590, 1522, 1603, 1582, 1596, 1550, 1594, 1575, 1604,
                            1526, 1547, 1565, 1536, 1526, 1525, 1583, 1602, 1603, 1532, 1549,
                            1540, 1590, 1523},
                    {1553, 1520, 1518, 1553, 1550, 1581, 1548, 1518, 1589, 1536, 1571,
                            1575, 1564, 1589, 1537, 1526, 1535, 1603, 1545, 1580, 1600, 1570,
                            1603, 1591, 1591, 1601, 1605, 1605, 1521, 1556, 1558, 1544, 1551,
                            1566, 1579, 1522},
                    {1528, 1554, 1532, 1604, 1549, 1525, 1542, 1564, 1545, 1600, 1540,
                            1527, 1553, 1524, 1550, 1525, 1566, 1535, 1586, 1588, 1560, 1537,
                            1595, 1582, 1589, 1545, 1539, 1523, 1551, 1591, 1569, 1539, 1605,
                            1587, 1529, 1550},
                    {1574, 1549, 1540, 1538, 1527, 1559, 1587, 1554, 1557, 1554, 1568,
                            1555, 1563, 1560, 1522, 1581, 1527, 1591, 1590, 1535, 1524, 1523,
                            1550, 1582, 1603, 1582, 1594, 1542, 1557, 1527, 1522, 1593, 1597,
                            1527, 1592, 1603},
                    {1524, 1605, 1566, 1589, 1530, 1557, 1536, 1578, 1570, 1563, 1578,
                            1553, 1599, 1535, 1584, 1526, 1532, 1567, 1532, 1602, 1601, 1599,
                            1585, 1526, 1530, 1573, 1596, 1532, 1529, 1532, 1560, 1569, 1600,
                            1569, 1526, 1564},
                    {1569, 1552, 1579, 1567, 1550, 1598, 1540, 1568, 1528, 1532, 1590,
                            1536, 1605, 1596, 1597, 1598, 1583, 1563, 1549, 1518, 1530, 1592,
                            1594, 1529, 1585, 1529, 1571, 1585, 1537, 1586, 1583, 1592, 1605,
                            1600, 1549, 1554},
                    {1574, 1525, 1582, 1594, 1520, 1546, 1561, 1533, 1572, 1559, 1525,
                            1554, 1525, 1588, 1537, 1587, 1576, 1540, 1597, 1524, 1548, 1539,
                            1521, 1560, 1572, 1592, 1585, 1529, 1526, 1549, 1558, 1533, 1567,
                            1525, 1521, 1570},
                    {1524, 1563, 1535, 1528, 1518, 1570, 1553, 1569, 1568, 1572, 1579,
                            1558, 1544, 1521, 1569, 1522, 1564, 1524, 1526, 1588, 1589, 1557,
                            1533, 1604, 1605, 1586, 1542, 1531, 1523, 1542, 1594, 1577, 1605,
                            1522, 1545, 1579},
                    {1574, 1601, 1587, 1563, 1564, 1603, 1533, 1605, 1586, 1530, 1562,
                            1539, 1548, 1599, 1538, 1601, 1575, 1526, 1604, 1547, 1571, 1573,
                            1546, 1536, 1582, 1534, 1538, 1603, 1603, 1571, 1594, 1566, 1543,
                            1561, 1590, 1548},
                    {1586, 1519, 1519, 1539, 1522, 1538, 1558, 1532, 1569, 1564, 1603,
                            1599, 1563, 1523, 1549, 1522, 1587, 1535, 1553, 1573, 1577, 1561,
                            1604, 1536, 1561, 1582, 1589, 1598, 1534, 1572, 1548, 1558, 1523,
                            1561, 1582, 1555},
                    {1564, 1554, 1585, 1595, 1541, 1582, 1562, 1601, 1591, 1555, 1577,
                            1533, 1558, 1585, 1550, 1522, 1549, 1586, 1578, 1599, 1588, 1536,
                            1600, 1602, 1556, 1567, 1561, 1518, 1536, 1558, 1602, 1601, 1551,
                            1529, 1541, 1600},
                    {1539, 1602, 1548, 1519, 1599, 1605, 1588, 1565, 1547, 1588, 1555,
                            1539, 1544, 1593, 1536, 1535, 1586, 1529, 1533, 1530, 1563, 1562,
                            1589, 1570, 1531, 1555, 1600, 1588, 1568, 1605, 1529, 1604, 1567,
                            1580, 1537, 1525},
                    {1574, 1560, 1537, 1562, 1603, 1564, 1599, 1541, 1575, 1540, 1581,
                            1599, 1543, 1587, 1527, 1578, 1521, 1570, 1567, 1591, 1541, 1570,
                            1532, 1593, 1570, 1563, 1559, 1518, 1553, 1596, 1569, 1540, 1519,
                            1587, 1574, 1565},
                    {1530, 1599, 1550, 1555, 1537, 1565, 1548, 1602, 1552, 1559, 1573,
                            1537, 1536, 1520, 1577, 1531, 1557, 1522, 1561, 1587, 1554, 1591,
                            1562, 1592, 1523, 1575, 1593, 1536, 1531, 1564, 1572, 1554, 1588,
                            1548, 1542, 1521},
                    {1597, 1539, 1551, 1581, 1600, 1605, 1595, 1554, 1549, 1531, 1565,
                            1521, 1601, 1602, 1565, 1576, 1600, 1568, 1549, 1524, 1534, 1553,
                            1576, 1540, 1592, 1548, 1590, 1551, 1594, 1594, 1573, 1521, 1588,
                            1580, 1546, 1566},
                    {1531, 1559, 1527, 1545, 1581, 1547, 1604, 1572, 1575, 1571, 1588,
                            1544, 1585, 1580, 1527, 1603, 1578, 1582, 1553, 1527, 1596, 1586,
                            1518, 1539, 1590, 1536, 1579, 1577, 1578, 1574, 1599, 1546, 1548,
                            1590, 1598, 1605},
                    {1563, 1529, 1521, 1572, 1536, 1557, 1570, 1569, 1543, 1529, 1531,
                            1541, 1575, 1558, 1536, 1587, 1552, 1528, 1595, 1550, 1570, 1530,
                            1591, 1596, 1541, 1547, 1583, 1603, 1533, 1593, 1529, 1545, 1532,
                            1569, 1551, 1557}};
    int i = 0;
    for (i = 0; i < 36; i++)
    {
        buffer[i] = (aa[num][i] - 1483);
    }
    (*env)->SetIntArrayRegion(env, jcharArray1, 0, 36, buffer);
    return jcharArray1;
}